{"remainingRequest":"/Users/hanyue/development/github/vue-components/node_modules/babel-loader/lib/index.js!/Users/hanyue/development/github/vue-components/node_modules/eslint-loader/index.js??ref--13-0!/Users/hanyue/development/github/vue-components/src/package/kVuex/KVuex.js","dependencies":[{"path":"/Users/hanyue/development/github/vue-components/src/package/kVuex/KVuex.js","mtime":1579083688773},{"path":"/Users/hanyue/development/github/vue-components/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hanyue/development/github/vue-components/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/hanyue/development/github/vue-components/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvVXNlcnMvaGFueXVlL2RldmVsb3BtZW50L2dpdGh1Yi92dWUtY29tcG9uZW50cy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIi9Vc2Vycy9oYW55dWUvZGV2ZWxvcG1lbnQvZ2l0aHViL3Z1ZS1jb21wb25lbnRzL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7Ci8vIDEu5YiG5Lik6YOo5YiGIOS4gOS4quaYryDmnoTlu7pTdG9yZeeahOWunuS+iyDkuIDkuKrmmK8g5p6E5bu6aW5zdGFsbOe7hOS7tgovLyAyLlN0b3JlIOimgeWunueOsCBjb21taXQgZGlzcGF0Y2ggc3RhdGUg5bm25LiU5oqKc3RhdGXnvJbnqIvlk43lupTlvI/mlbDmja4KLy8gMy5pbnN0YWxsIOimgeWunueOsOaMgui9vSRTdG9yZeWIsOWFqOWxgAovLyA0LuWunueOsGdldHRlciDliKnnlKhWdWXnmoTorqHnrpflsZ7mgKcKaW1wb3J0IEtNb2R1bGVDbGxlY3Rpb24gZnJvbSAnLi9LTW9kdWxlQ2xsZWN0aW9uJzsKdmFyIFZ1ZTsKCnZhciBTdG9yZSA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFN0b3JlKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFN0b3JlKTsKCiAgICB2YXIgZGlzcGF0Y2ggPSB0aGlzLmRpc3BhdGNoLAogICAgICAgIGNvbW1pdCA9IHRoaXMuY29tbWl0OyAvLyDkuLptdXRhdGlvbnMg5LiOIGFjdGlvbnPotYvlgLwKCiAgICB0aGlzLl9tdXRhdGlvbnMgPSBvcHRpb25zLm11dGF0aW9ucyB8fCB7fTsKICAgIHRoaXMuX2FjdGlvbnMgPSBvcHRpb25zLmFjdGlvbnMgfHwge307CiAgICB0aGlzLl93YXBwZXJHZXR0ZXIgPSBvcHRpb25zLmdldHRlcnM7CiAgICB0aGlzLl9tb2R1bGVzID0gbmV3IEtNb2R1bGVDbGxlY3Rpb24ob3B0aW9ucyk7CiAgICB2YXIgc3RvcmUgPSB0aGlzOwogICAgdmFyIGNvbXB1dGVkID0ge307IC8vIOWunueOsGdldHRlcgoKICAgIHRoaXMuZ2V0dGVycyA9IHt9OwogICAgT2JqZWN0LmtleXModGhpcy5fd2FwcGVyR2V0dGVyKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgdmFyIGZuID0gc3RvcmUuX3dhcHBlckdldHRlcltrZXldOwoKICAgICAgY29tcHV0ZWRba2V5XSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gZm4oc3RvcmUuc3RhdGUpOwogICAgICB9OwoKICAgICAgT2JqZWN0LmtleXMoX3RoaXMuX3dhcHBlckdldHRlcikuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHN0b3JlLmdldHRlcnMsIGtleSwgewogICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICAgIHJldHVybiBzdG9yZS5fdm1ba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9KTsKICAgIHRoaXMuaW5zdGFsbE1vZHVsZSh0aGlzLCB0aGlzLl9tb2R1bGVzLnJvb3Quc3RhdGUsIHRoaXMuX21vZHVsZXMucm9vdCk7IC8vIOWumuS5iXN0YXRlCiAgICAvLyDlsIZzdGF0Zee8lueoi+WTjeW6lOW8j+aVsOaNrgogICAgLy8g5bm25Yqg5LiA5bGCIOS9v+eUqCBnZXQg6Zi75q2ic3RhdGXooqvkv67mlLkg5L2/55SoJCTmmK/lm6DkuLrkuI3kvJrooqt2dWXop6PmnpAKCiAgICB2YXIgc3RhdGUgPSB0aGlzLl9tb2R1bGVzLnJvb3Quc3RhdGU7CiAgICB0aGlzLl92bSA9IG5ldyBWdWUoewogICAgICBkYXRhOiB7CiAgICAgICAgJCRzdGF0ZTogc3RhdGUKICAgICAgfSwKICAgICAgY29tcHV0ZWQ6IGNvbXB1dGVkCiAgICB9KTsKCiAgICB0aGlzLmNvbW1pdCA9IGZ1bmN0aW9uICh0eXBlLCBwYXlsb2FkKSB7CiAgICAgIHJldHVybiBjb21taXQuY2FsbChzdG9yZSwgdHlwZSwgcGF5bG9hZCk7CiAgICB9OwoKICAgIHRoaXMuZGlzcGF0Y2ggPSBmdW5jdGlvbiAodHlwZSwgcGF5bG9hZCkgewogICAgICByZXR1cm4gZGlzcGF0Y2guY2FsbChzdG9yZSwgdHlwZSwgcGF5bG9hZCk7CiAgICB9OwoKICAgIHdpbmRvdy5jb25zb2xlLmxvZyh0aGlzKTsKICB9CgogIF9jcmVhdGVDbGFzcyhTdG9yZSwgW3sKICAgIGtleTogImNvbW1pdCIsCiAgICAvLyBfdHlwZSDooajnpLrnsbvlnosgX3BheWxvYWQg6L296I23IOeUqOadpeihqOekuuWPguaVsAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbW1pdChfdHlwZSwgX3BheWxvYWQpIHsKICAgICAgdGhpcy5fbXV0YXRpb25zW190eXBlXSh0aGlzLnN0YXRlLCBfcGF5bG9hZCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZGlzcGF0Y2giLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRpc3BhdGNoKF90eXBlLCBfcGF5bG9hZCkgewogICAgICB0aGlzLl9hY3Rpb25zW190eXBlXSh0aGlzLCBfcGF5bG9hZCk7CiAgICB9IC8vIOWIm+W7um1vZHVsZSDmioptb2R1bGXlrp7kvovkuIrnmoTmlrnms5XlhajmjILovb3liLBzdG9yZeS4igoKICB9LCB7CiAgICBrZXk6ICJpbnN0YWxsTW9kdWxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpbnN0YWxsTW9kdWxlKHN0b3JlLCBzdGF0ZSwgbW9kdWxlKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgT2JqZWN0LmFzc2lnbihzdG9yZS5fbW9kdWxlcy5yb290LnN0YXRlLCBzdGF0ZSk7IC8vIOW+queOr+avj+S4quiKgueCueS4iueahG11dGF0aW9ucwoKICAgICAgbW9kdWxlLmZvckVhY2hNdXRhdGlvbnMoZnVuY3Rpb24gKGtleSwgbXV0YXRpb25zKSB7CiAgICAgICAgc3RvcmUuX211dGF0aW9uc1trZXldID0gbXV0YXRpb25zOwogICAgICB9KTsgLy8g5b6q546v5q+P5Liq6IqC54K55LiK55qEYWN0aW9ucwoKICAgICAgbW9kdWxlLmZvckVhY2hBY3Rpb25zKGZ1bmN0aW9uIChrZXksIGFjdGlvbnMpIHsKICAgICAgICBzdG9yZS5fYWN0aW9uc1trZXldID0gYWN0aW9uczsKICAgICAgfSk7CiAgICAgIG1vZHVsZS5mb3JFYWNoQ2hpbGQoZnVuY3Rpb24gKGtleSwgY2hpbGRyZW4pIHsKICAgICAgICBfdGhpczIuaW5zdGFsbE1vZHVsZShzdG9yZSwgY2hpbGRyZW4uc3RhdGUsIGNoaWxkcmVuKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAic3RhdGUiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl92bS5fZGF0YS4kJHN0YXRlOwogICAgfSwKICAgIHNldDogZnVuY3Rpb24gc2V0KHYpIHsKICAgICAgd2luZG93LmNvbnNvbGUuZXJyb3IoJ+S4jeimgeebtOaOpeS/ruaUuXN0YXRlJyk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gU3RvcmU7Cn0oKTsKCnZhciBpbnN0YWxsID0gZnVuY3Rpb24gaW5zdGFsbChfVnVlKSB7CiAgVnVlID0gX1Z1ZTsgLy/kvb/nlKhtaXhpbiwg5ou/5Yiw5a6e5L6L5ZCO55qE55u45YWz5bGe5oCn5bm25oyC6L295YiwcHJvdG90eXBl5LiKCgogIFZ1ZS5taXhpbih7CiAgICBiZWZvcmVDcmVhdGU6IGZ1bmN0aW9uIGJlZm9yZUNyZWF0ZSgpIHsKICAgICAgLy8g5ou/5YiwdnVl5oyC6L295Yiw5omA5pyJ5bGe5oCnIOS7peWQjuWPr+S7peS9v+eUqHRoaXMuJHN0b3Jl6LCD55So5a6e5L6LCiAgICAgIGlmICh0aGlzLiRvcHRpb25zLnN0b3JlKSB7CiAgICAgICAgVnVlLnByb3RvdHlwZS4kU3RvcmUgPSB0aGlzLiRvcHRpb25zLnN0b3JlOwogICAgICB9CiAgICB9CiAgfSk7Cn07CgpleHBvcnQgZGVmYXVsdCB7CiAgU3RvcmU6IFN0b3JlLAogIGluc3RhbGw6IGluc3RhbGwKfTs="},{"version":3,"sources":["/Users/hanyue/development/github/vue-components/src/package/kVuex/KVuex.js"],"names":["KModuleCllection","Vue","Store","options","dispatch","commit","_mutations","mutations","_actions","actions","_wapperGetter","getters","_modules","store","computed","Object","keys","forEach","key","fn","state","defineProperty","get","_vm","installModule","root","data","$$state","type","payload","call","window","console","log","_type","_payload","module","assign","forEachMutations","forEachActions","forEachChild","children","_data","v","error","install","_Vue","mixin","beforeCreate","$options","prototype","$Store"],"mappings":"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","sourcesContent":["// 1.分两部分 一个是 构建Store的实例 一个是 构建install组件\n// 2.Store 要实现 commit dispatch state 并且把state编程响应式数据\n// 3.install 要实现挂载$Store到全局\n// 4.实现getter 利用Vue的计算属性\n\nimport KModuleCllection from './KModuleCllection';\n\nlet Vue;\n\nclass Store {\n    constructor(options = {}) {\n        const { dispatch, commit } = this;\n\n        // 为mutations 与 actions赋值\n        this._mutations = options.mutations || {};\n        this._actions = options.actions || {};\n        this._wapperGetter = options.getters;\n        this._modules = new KModuleCllection(options);\n\n        const store = this;\n        const computed = {};\n        // 实现getter\n        this.getters = {};\n        Object.keys(this._wapperGetter).forEach(key => {\n            let fn = store._wapperGetter[key];\n            computed[key] = function() {\n                return fn(store.state);\n            };\n\n            Object.keys(this._wapperGetter).forEach(key => {\n                Object.defineProperty(store.getters, key, {\n                    get: () => store._vm[key]\n                });\n            });\n        });\n\n        this.installModule(this, this._modules.root.state, this._modules.root);\n\n        // 定义state\n        // 将state编程响应式数据\n        // 并加一层 使用 get 阻止state被修改 使用$$是因为不会被vue解析\n        const state = this._modules.root.state;\n        this._vm = new Vue({\n            data: {\n                $$state: state\n            },\n            computed\n        });\n        \n        this.commit = function(type, payload) {\n            return commit.call(store, type, payload);\n        }\n        this.dispatch = function(type, payload) {\n            return dispatch.call(store, type, payload);\n        }\n\n        window.console.log(this);\n    }\n\n    get state() {\n        return this._vm._data.$$state\n    }\n\n    set state (v) {\n        window.console.error('不要直接修改state');\n    }\n     \n    // _type 表示类型 _payload 载荷 用来表示参数\n    commit(_type, _payload) {\n        this._mutations[_type](this.state, _payload);\n    }\n\n    dispatch(_type, _payload) {\n        this._actions[_type](this, _payload);\n    }\n\n    // 创建module 把module实例上的方法全挂载到store上\n    installModule(store, state, module) {\n        Object.assign(store._modules.root.state, state);\n\n        // 循环每个节点上的mutations\n        module.forEachMutations((key, mutations) => {\n            store._mutations[key] = mutations;\n        })\n\n        // 循环每个节点上的actions\n        module.forEachActions((key, actions) => {\n            store._actions[key] = actions;\n        })\n\n        module.forEachChild((key, children) => {\n            this.installModule(store, children.state, children) \n        })\n    }\n}\n\nconst install = function(_Vue) {\n    Vue = _Vue;\n\n    //使用mixin, 拿到实例后的相关属性并挂载到prototype上\n    Vue.mixin({\n        beforeCreate() {\n            // 拿到vue挂载到所有属性 以后可以使用this.$store调用实例\n            if (this.$options.store) {\n                Vue.prototype.$Store = this.$options.store;\n            }\n        }\n    })\n}\n\nexport default {\n    Store,\n    install\n}"]}]}
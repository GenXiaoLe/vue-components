{"remainingRequest":"/Users/hanyue/development/github/vue-components/node_modules/babel-loader/lib/index.js!/Users/hanyue/development/github/vue-components/node_modules/eslint-loader/index.js??ref--13-0!/Users/hanyue/development/github/vue-components/src/package/kVueRouter/KVueRouter.js","dependencies":[{"path":"/Users/hanyue/development/github/vue-components/src/package/kVueRouter/KVueRouter.js","mtime":1578279839540},{"path":"/Users/hanyue/development/github/vue-components/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hanyue/development/github/vue-components/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/hanyue/development/github/vue-components/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pbmNsdWRlcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2giOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIi9Vc2Vycy9oYW55dWUvZGV2ZWxvcG1lbnQvZ2l0aHViL3Z1ZS1jb21wb25lbnRzL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiL1VzZXJzL2hhbnl1ZS9kZXZlbG9wbWVudC9naXRodWIvdnVlLWNvbXBvbmVudHMvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKLy8gMS4g5p6E5bu65LiA5Liq5a6e5L6LCi8vIDIuIOWunuS+i+S4reebkeWQrOWcsOWdgOWPmOWMliwg5bm25ZON5bqU5byP55qE5riy5p+T55WM6Z2iCi8vIDMuIOWunuS+i+S4rWluc3RhbGzlrp7njrDkuIDkuKrmj5Lku7YsIOaMgui9veWIsCRyb3V0ZXIKLy8gNC4g5a6e546wcm91dGVyLWxpbmsgcm91dGVyLXZpZXfkuKTkuKrnu4Tku7YgCi8vIOW1jOWll+i3r+eUseimgeeCuQovLyBLVnVlUm91dGVy57uE5Lu2Ci8vIDEu5ZON5bqU5byPY3VycmVudOWPmOS4uuS4gOS4quWTjeW6lOW8j+aVsOe7hG1hdGNocwovLyAyLuW+queOr+aKiuaJgOacieeahOebuOWFs+i3r+eUsemDveaUvuWIsG1hdGNoc+aVsOe7hOWGhQovLyBSb3V0ZXJWaWV357uE5Lu2Ci8vIDEu5qCH6K6w57uE5Lu25Li6cm91dGVyLXZpZXcg5pa55L6/6YGN5Y6G5p+l5om+Ci8vIDIu5a6a5LmJ5LiA5Liq5Y+Y6YePZGVlcOS7o+ihqOa3seW6piDooajnpLrmmK/nrKzlh6DlsYLlj5jph48g5Y2z5rex5bqm5qCH6K6wCi8vIDMu5b6q546v5p+l5om+54i257qncm91dGVyLXZpZXcg5pS55Y+YZGVlcAovLyA0LuWIqeeUqGRlZXAg5ZKMIG1hdGNoc+WvueavlCDmib7lh7rlk43lupTnu4Tku7bov5Tlm54KLy8g55Sz5piO5LiA5LiqVnVl5Y+Y6YePLCDpmLLmraJpbXBvcnTlvJXlhaXlr7zoh7TmiZPljIXml7bmiopWdWXph43lpI3miZPljIXov5vljrsKdmFyIFZ1ZTsKCnZhciBLVnVlUm91dGVyID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gS1Z1ZVJvdXRlcihvcHRpb25zKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgS1Z1ZVJvdXRlcik7CgogICAgdGhpcy4kb3B0aW9ucyA9IG9wdGlvbnM7IC8vIOWAn+WKqXZ1ZeWTjeW6lOW8j+aKiuWug+WPmOaIkOWTjeW6lOW8j+aVsOaNrgoKICAgIHRoaXMuY3VycmVudCA9IHdpbmRvdy5sb2NhdGlvbi5oYXNoLnNsaWNlKDEpIHx8ICcvJzsgLy8gVnVlLnV0aWwuZGVmaW5lUmVhY3RpdmUodGhpcywgJ2N1cnJlbnQnLCB3aW5kb3cubG9jYXRpb24uaGFzaC5zbGljZSgxKSB8fCAnLycpOwogICAgLy8g5ZON5bqU5byP55qE5Yib5bu66Lev55Sx5pWw57uEbWF0Y2gKCiAgICBWdWUudXRpbC5kZWZpbmVSZWFjdGl2ZSh0aGlzLCAnbWF0Y2hlZCcsIFtdKTsKICAgIHRoaXMubWF0Y2hzKHRoaXMuJG9wdGlvbnMpOyAvLyDnm5HlkKzmi7/liLDlnLDlnYDlubbkv67mlLnlnLDlnYAKCiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignaGFzaGNoYW5nZScsIHRoaXMuY3VycmVudEhhc2guYmluZCh0aGlzKSk7CiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIHRoaXMuY3VycmVudEhhc2guYmluZCh0aGlzKSk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoS1Z1ZVJvdXRlciwgW3sKICAgIGtleTogImN1cnJlbnRIYXNoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjdXJyZW50SGFzaCgpIHsKICAgICAgdGhpcy5jdXJyZW50ID0gd2luZG93LmxvY2F0aW9uLmhhc2guc2xpY2UoMSk7CiAgICAgIHRoaXMubWF0Y2hlZCA9IFtdOwogICAgICB0aGlzLm1hdGNocyh0aGlzLiRvcHRpb25zKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJtYXRjaHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG1hdGNocyhyb3V0ZXJzKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByb3V0ZXJzLmZvckVhY2goZnVuY3Rpb24gKHJvdXRlcikgewogICAgICAgIC8vIOS4gOiIrOadpeivtC/ot6/lvoTkuIvkuI3kvJrlrZjmlL7ltYzlpZfot6/nlLEg5omA5Lul55u05o6lcHVzaAogICAgICAgIGlmIChfdGhpcy5jdXJyZW50ID09PSAnLycgJiYgcm91dGVyLnBhdGggPT09ICcvJykgewogICAgICAgICAgX3RoaXMubWF0Y2hlZC5wdXNoKHJvdXRlcik7CiAgICAgICAgfSBlbHNlIGlmIChfdGhpcy5jdXJyZW50LmluY2x1ZGVzKHJvdXRlci5wYXRoKSAmJiByb3V0ZXIucGF0aCAhPT0gJy8nKSB7CiAgICAgICAgICBfdGhpcy5tYXRjaGVkLnB1c2gocm91dGVyKTsKCiAgICAgICAgICBpZiAocm91dGVyLmNoaWxkcmVuKSB7CiAgICAgICAgICAgIF90aGlzLm1hdGNocyhyb3V0ZXIuY2hpbGRyZW4pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gS1Z1ZVJvdXRlcjsKfSgpOwoKS1Z1ZVJvdXRlci5pbnN0YWxsID0gZnVuY3Rpb24gKF9WdWUpIHsKICBWdWUgPSBfVnVlOyAvL+S9v+eUqG1peGluLCDmi7/liLDlrp7kvovlkI7nmoTnm7jlhbPlsZ7mgKflubbmjILovb3liLBwcm90b3R5cGXkuIoKCiAgVnVlLm1peGluKHsKICAgIGJlZm9yZUNyZWF0ZTogZnVuY3Rpb24gYmVmb3JlQ3JlYXRlKCkgewogICAgICAvLyDmi7/liLB2dWXmjILovb3liLDmiYDmnInlsZ7mgKcg5Lul5ZCO5Y+v5Lul5L2/55SodGhpcy4kcm91dGVy6LCD55So5a6e5L6LCiAgICAgIGlmICh0aGlzLiRvcHRpb25zLnJvdXRlcikgewogICAgICAgIFZ1ZS5wcm90b3R5cGUuJHJvdXRlciA9IHRoaXMuJG9wdGlvbnMucm91dGVyOwogICAgICB9CiAgICB9CiAgfSk7IC8vIOaMgui9vXJvdXRlci1saW5r57uE5Lu2CgogIFZ1ZS5jb21wb25lbnQoJ1JvdXRlckxpbmsnLCB7CiAgICBwcm9wczogewogICAgICB0bzogewogICAgICAgIHR5cGU6IFN0cmluZywKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICB9CiAgICB9LAogICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoaCkgewogICAgICByZXR1cm4gaCgnYScsIHsKICAgICAgICBhdHRyczogewogICAgICAgICAgaHJlZjogIiMiLmNvbmNhdCh0aGlzLnRvKQogICAgICAgIH0KICAgICAgfSwgW3RoaXMuJHNsb3RzLmRlZmF1bHRdKTsKICAgIH0KICB9KTsgLy8g5oyC6L29cm91dGVyLXZpZXfnu4Tku7YKCiAgVnVlLmNvbXBvbmVudCgnUm91dGVyVmlldycsIHsKICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKGgpIHsKICAgICAgdmFyIGRlZXAgPSAwOyAvLyDlsIbnu4Tku7bmoIforrAKCiAgICAgIHRoaXMucm91dGVyVmlldyA9IHRydWU7IC8vIOW+queOr+aJvuWHuuaJgOacieeItuWFg+e0oCDlubbmoIforrDmt7HluqYKCiAgICAgIHZhciBwYXJlbnQgPSB0aGlzLiRwYXJlbnQ7CgogICAgICB3aGlsZSAocGFyZW50KSB7CiAgICAgICAgaWYgKHBhcmVudCAmJiBwYXJlbnQucm91dGVyVmlldykgewogICAgICAgICAgZGVlcCArPSAxOwogICAgICAgIH0KCiAgICAgICAgcGFyZW50ID0gcGFyZW50LiRwYXJlbnQ7CiAgICAgIH0gLy8g5Yy56YWN5rex5bqm5bGC57qnIOaJvuWHumNvbXBvbmVudAoKCiAgICAgIHZhciBtYXRjaGVkID0gdGhpcy4kcm91dGVyLm1hdGNoZWQ7CiAgICAgIHZhciBfY29tcG9uZW50ID0gbnVsbDsKCiAgICAgIGlmIChtYXRjaGVkW2RlZXBdKSB7CiAgICAgICAgX2NvbXBvbmVudCA9IG1hdGNoZWRbZGVlcF0uY29tcG9uZW50czsKICAgICAgfQoKICAgICAgcmV0dXJuIGgoX2NvbXBvbmVudCk7CiAgICB9CiAgfSk7Cn07CgpleHBvcnQgZGVmYXVsdCBLVnVlUm91dGVyOw=="},{"version":3,"sources":["/Users/hanyue/development/github/vue-components/src/package/kVueRouter/KVueRouter.js"],"names":["Vue","KVueRouter","options","$options","current","window","location","hash","slice","util","defineReactive","matchs","addEventListener","currentHash","bind","matched","routers","forEach","router","path","push","includes","children","install","_Vue","mixin","beforeCreate","prototype","$router","component","props","to","type","String","required","render","h","attrs","href","$slots","default","deep","routerView","parent","$parent","_component","components"],"mappings":"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","sourcesContent":["// 1. 构建一个实例\n// 2. 实例中监听地址变化, 并响应式的渲染界面\n// 3. 实例中install实现一个插件, 挂载到$router\n// 4. 实现router-link router-view两个组件 \n\n// 嵌套路由要点\n// KVueRouter组件\n// 1.响应式current变为一个响应式数组matchs\n// 2.循环把所有的相关路由都放到matchs数组内\n// RouterView组件\n// 1.标记组件为router-view 方便遍历查找\n// 2.定义一个变量deep代表深度 表示是第几层变量 即深度标记\n// 3.循环查找父级router-view 改变deep\n// 4.利用deep 和 matchs对比 找出响应组件返回\n\n// 申明一个Vue变量, 防止import引入导致打包时把Vue重复打包进去\nlet Vue;\n\nclass KVueRouter {\n    constructor(options) {\n        this.$options = options;\n        // 借助vue响应式把它变成响应式数据\n        this.current = window.location.hash.slice(1) || '/';\n        // Vue.util.defineReactive(this, 'current', window.location.hash.slice(1) || '/');\n\n        // 响应式的创建路由数组match\n        Vue.util.defineReactive(this, 'matched', []);\n        this.matchs(this.$options);\n\n        // 监听拿到地址并修改地址\n        window.addEventListener('hashchange', this.currentHash.bind(this));\n        window.addEventListener('load', this.currentHash.bind(this));\n    }\n\n    currentHash() {\n        this.current = window.location.hash.slice(1);\n        this.matched = [];\n        this.matchs(this.$options);\n    }\n\n    matchs(routers) {\n        routers.forEach(router => {\n            // 一般来说/路径下不会存放嵌套路由 所以直接push\n            if (this.current === '/' && router.path === '/') {\n                this.matched.push(router);\n            } else if (this.current.includes(router.path) && router.path !== '/') {\n                this.matched.push(router);\n                if (router.children) {\n                    this.matchs(router.children);\n                }\n            }\n        });\n    }\n}\n\nKVueRouter.install = function(_Vue) {\n    Vue = _Vue;\n\n    //使用mixin, 拿到实例后的相关属性并挂载到prototype上\n    Vue.mixin({\n        beforeCreate() {\n            // 拿到vue挂载到所有属性 以后可以使用this.$router调用实例\n            if (this.$options.router) {\n                Vue.prototype.$router = this.$options.router;\n            }\n        }\n    })\n\n    // 挂载router-link组件\n    Vue.component('RouterLink', {\n        props: {\n            to: {\n                type: String,\n                required: true\n            }\n        },\n        render(h) {\n            return h(\n                'a',\n                {\n                    attrs: {\n                        href: `#${this.to}`\n                    }\n                },\n                [\n                    this.$slots.default\n                ]\n            ) \n        }\n    })\n\n    // 挂载router-view组件\n    Vue.component('RouterView', {\n        render(h) {\n            let deep = 0;\n            // 将组件标记\n            this.routerView = true;\n            // 循环找出所有父元素 并标记深度\n            let parent = this.$parent;\n            while(parent) {\n                if (parent && parent.routerView) {\n                    deep += 1;\n                }\n                parent = parent.$parent;\n            }\n\n            // 匹配深度层级 找出component\n            let matched = this.$router.matched;\n            let _component = null;\n            if (matched[deep]) {\n                _component = matched[deep].components;\n            }\n            return h(_component)\n        }\n    })\n}\n\nexport default KVueRouter"]}]}